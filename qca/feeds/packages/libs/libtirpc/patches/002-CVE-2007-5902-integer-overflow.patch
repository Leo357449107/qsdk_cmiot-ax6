From 01b3b9cbb23f8e8790ba0daeac24667c4f9f34ea Fri Dec 14 00:00:00 2007
From: Taylor Yu <tlyu@mit.edu>
Date: Thu, 6 May 2021 13:01:49 +0530
Subject: [PATCH] fix CVE-2007-5902: integer overflow in svcauth_gss_get_principal()

ticket: 5855
target_version: 1.6.4
tags: pullup

git-svn-id: svn://anonsvn.mit.edu/krb5/trunk@20181 dc483132-0cff-0310-8789-dd5450dbe970

Signed-off-by: Taylor Yu <tlyu@mit.edu>

Index: libtirpc-1.2.6/src/svc_auth_gss.c
===================================================================
--- libtirpc-1.2.6.orig/src/svc_auth_gss.c
+++ libtirpc-1.2.6/src/svc_auth_gss.c
@@ -873,7 +873,7 @@ svcauth_gss_get_principal(SVCAUTH *auth)
 
 	gd = SVCAUTH_PRIVATE(auth);
 
-	if (gd->cname.length == 0)
+	if (gd->cname.length == 0 || gd->cname.length >= SIZE_MAX)
 		return (NULL);
 
 	if ((pname = malloc(gd->cname.length + 1)) == NULL)
